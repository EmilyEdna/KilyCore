
@{
    ViewData["Title"] = "DataV";
    Layout = "~/Views/Shared/BaseView.cshtml";
}
@section css{
    <style>
        #cbody {
            background-image: url('/statichtml/staticimg/backdatav.png');
            background-size: cover;
            background-repeat: no-repeat;
        }
    </style>
}
@section script{
    <script>
        var options = {
            Init: function () {
                this.InitDom();
                this.InitEvents();
            },
            InitDom: function () {
                //企业统计
                controller.ajax({
                    url: "GovtWeb/GetPieDataForCompany",
                    data: {},
                    type: "post",
                    async: false,
                    success: function (result) {
                        echarts.init($("#echarts-pie-chart-com")[0],"infographic").setOption(OptionPie = {
                            title: {
                                textStyle: {color:'#ffffff'}
                            },
                            tooltip: {
                                trigger: 'item',
                                formatter: "{a} <br/>{b}: {c} ({d}%)"
                            },
                            legend: {
                                orient: 'vertical',
                                x: 'left',
                                data: result.data.DataTitle
                            },
                            series: [
                                {
                                    name: (result.data.Name == null ? '未审核统计' : result.data.Name),
                                    type: 'pie',
                                    selectedMode: 'single',
                                    radius: [0, '30%'],
                                    data: result.data.InSideData,
                                },
                                {
                                    name: (result.data.Name == null ? '已审核统计' : result.data.Name),
                                    type: 'pie',
                                    radius: ['40%', '55%'],
                                    data: result.data.OutSideData
                                }
                            ],
                            backgroundColor: 'rgba(255,255,255,0)',
                            color: ["#fc97af", "#87f7cf", '#f7f494', '#72ccff', '#f7c5a0', '#d4a4eb', '#d2f5a6','#76f2f2']
                        });
                    }
                });
                //产品统计
                controller.ajax({
                    url: "GovtWeb/GetPieDataForProduct",
                    data: {},
                    type: "post",
                    async: false,
                    success: function (result) {
                        echarts.init($("#echarts-pie-chart-pro")[0]).setOption(OptionPie = {
                            title: {
                                textStyle: { color: '#ffffff' }
                            },
                            tooltip: {
                                trigger: 'item',
                                formatter: "{a} <br/>{b}: {c} ({d}%)"
                            },
                            legend: {
                                orient: 'vertical',
                                x: 'left',
                                data: result.data.DataTitle
                            },
                            series: [
                                {
                                    name: (result.data.Name == null ? '未审核统计' : result.data.Name),
                                    type: 'pie',
                                    selectedMode: 'single',
                                    radius: [0, '30%'],
                                    data: result.data.InSideData
                                },
                                {
                                    name: (result.data.Name == null ? '已审核统计' : result.data.Name),
                                    type: 'pie',
                                    radius: ['40%', '55%'],
                                    data: result.data.OutSideData
                                },
                            ],
                            backgroundColor: 'rgba(255,255,255,0)',
                            color: ["#fc97af", "#87f7cf", '#f7f494', '#72ccff', '#f7c5a0', '#d4a4eb', '#d2f5a6', '#76f2f2']
                        });
                    }
                });
                //地图
                controller.ajax({
                    url: "GovtWeb/GetAllCityMerchantCount",
                    data: {},
                    type: "post",
                    async: false,
                    success: function (result) {
                        OptionMap = {
                            title: {
                                text: '入住企业区域分布',
                            },
                            backgroundColor: 'rgba(7,31,65,0)',
                            tooltip: {
                                trigger: 'item',
                                formatter: '{b}<br/>{c} (家企业)'
                            },
                            dataRange: {
                                x: 'left',
                                y: 'bottom',
                                splitList: [
                                    { start: 10000 },
                                    { start: 5000,end:10000 },
                                    { start: 3000,end:5000 },
                                    { start: 1000, end: 3000 },
                                    { start: 500, end: 1000 },
                                    { start: 100, end: 500 },
                                    { start: 1, end: 100 },
                                ],
                                color: ['#fb2a00', '#ff9900', '#67ff00', '#00f5e1', '#0067f5', '#7c00f5', '#4b2b5a','#000000']
                            },
                            series: [
                                {
                                    name: '入住企业区域分布',
                                    type: 'map',
                                    mapType: result.data.CityName,
                                    itemStyle: {
                                        normal: { label: { show: true } },
                                        emphasis: { label: { show: true } }
                                    },
                                    data: result.data.DataList,
                                }
                            ]
                        }
                        $.getJSON("/CityMap/" + result.data.City + "00.json", function (res) {
                            echarts.registerMap(result.data.CityName, res);
                            echarts.init($("#echarts-map-chart")[0]).setOption(OptionMap);
                        });
                        var Names = [];
                        var Counts = [];
                        for (var i = 0; i < result.data.DataList.length; i++) {
                            Names.push(result.data.DataList[i].name);
                            Counts.push(result.data.DataList[i].value);
                        }
                        echarts.init($("#echarts-pie-chart-Lin")[0]).setOption(OptionPie = {
                            title: {
                                text: '入住企业总量排行',
                            },
                            tooltip: {
                                trigger: 'axis',
                                axisPointer: {
                                    type: 'shadow'
                                }
                            },
                            legend: {
                                data: ['企业入住数']
                            },
                            grid: {
                                left: '3%',
                                right: '4%',
                                bottom: '3%',
                                containLabel: true
                            },
                            xAxis: {
                                type: 'value',
                                boundaryGap: [0, 0.01],
                                axisLine: {
                                    lineStyle: {
                                        color: '#000',
                                        width: 2,
                                    }
                                }
                            },
                            yAxis: {
                                type: 'category',
                                data: Names,
                                axisLine: {
                                    lineStyle: {
                                        color: '#000',
                                        width: 2,
                                    }
                                }
                            },
                            series: [{
                                name: '企业数量',
                                type: 'bar',
                                data: Counts
                            }],
                            backgroundColor: 'rgba(7,31,65,0)',
                            color: ["#fc97af", "#87f7cf", '#f7f494', '#72ccff', '#f7c5a0', '#d4a4eb', '#d2f5a6', '#76f2f2']
                        });
                    }
                });
                //投诉率
                controller.ajax({
                    url: "GovtWeb/GetComplainCount",
                    data: {},
                    type: "post",
                    async: false,
                    success: function (result) {
                        OptionGauge = {
                            tooltip: {
                                formatter: "{a} <br/>{b} : {c}%"
                            },
                            series: [
                                {
                                    name: '投诉率',
                                    type: 'gauge',
                                    detail: { formatter: '{value}%' },
                                    data: result.data
                                }
                            ]
                        };
                        echarts.init($("#echarts-gauge-chart")[0]).setOption(OptionGauge);
                    }
                });
               

            },
            InitEvents: function () {

            }
        }
        $(document).ready(function () {
            options.Init();
        });
    </script>
}
    <div id="cbody" style="height:100%;width:100%">
        <!--企业统计-->
        <div class="col-sm-3" style="margin-top:5%;">
            <div class="echarts" id="echarts-pie-chart-com"></div>
        </div>
        <!--产品统计-->
        <div class="col-sm-3" style="margin-top:5%;">
            <div class="echarts" id="echarts-pie-chart-pro"></div>
        </div>
        <!--排名统计-->
        <div class="col-sm-3" style="margin-top:5%;">
            <div class="echarts" id="echarts-pie-chart-Lin"></div>
        </div>
        <!--地图-->
        <div class="col-sm-6" style="margin-top:10%;">
            <div class="echarts" id="echarts-map-chart"></div>
        </div>
        <!--投诉-->
        <div class="col-sm-6">
            <div class="row">
                <div class="col-sm-12">
                    <label class="label label-info">投诉率统计</label>
                    <div class="echarts" id="echarts-gauge-chart" style="height:500px;"></div>
                </div>
            </div>
        </div>
    </div>